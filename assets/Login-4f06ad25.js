import{d as L,u as T,r as b,l as k,c as C,e as l,w as o,g as R,h as n,i as U,b as a,j as i,E as v,_ as B}from"./index-19f31b93.js";const D={class:"login-container"},F={class:"test-account-section"},N={class:"test-account-info"},j={class:"register-link"},q=L({__name:"Login",setup(A){const g=R(),x=T(),p=b(),c=b(!1),f=localStorage.getItem("rememberedEmail")||"",t=k({email:f,password:"",rememberMe:!!f}),V=k({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}]}),_=async()=>{p.value&&await p.value.validate(async w=>{var e,m;if(w){c.value=!0;try{if(console.log("使用模拟登录功能..."),await new Promise(r=>setTimeout(r,1e3)),t.email&&t.password){t.rememberMe?localStorage.setItem("rememberedEmail",t.email):localStorage.removeItem("rememberedEmail");const r="mock-jwt-token-"+Date.now();let s={id:t.email==="test@example.com"?1001:Date.now(),username:t.email==="test@example.com"?"测试用户":t.email.split("@")[0],email:t.email,createdAt:new Date().toISOString()};t.email==="test@example.com"&&(s={...s,healthData:{height:175,weight:70,age:25,gender:"male",activityLevel:"moderate",healthGoals:["weightLoss","muscleBuilding"]},preferences:{preferredWorkoutTypes:["cardio","strength"],dietaryRestrictions:[],notificationSettings:!0}}),localStorage.setItem("token",r),localStorage.setItem("mockUser",JSON.stringify(s)),x.$patch({user:s}),v.success("登录成功"),setTimeout(()=>{g.push("/")},1500)}else throw new Error("邮箱和密码不能为空")}catch(r){console.error("登录失败:",r);let s="登录失败，请检查邮箱和密码";((e=r.response)==null?void 0:e.status)===401?s="邮箱或密码错误":((m=r.response)==null?void 0:m.status)===500?s="服务器错误，请稍后重试":r.message&&(s=r.message),v.error(s)}finally{c.value=!1}}})},S=()=>{g.push("/register")},h=async()=>{t.email="test@example.com",t.password="123456",t.rememberMe=!0,await _()};return(w,e)=>{const m=n("el-button"),r=n("el-alert"),s=n("el-input"),u=n("el-form-item"),E=n("el-checkbox"),y=n("el-link"),M=n("el-form"),I=n("el-card");return U(),C("div",D,[l(I,{class:"login-card"},{header:o(()=>[...e[3]||(e[3]=[a("div",{class:"login-header"},[a("span",null,"用户登录")],-1)])]),default:o(()=>[a("div",F,[l(r,{title:"测试账户",type:"info",closable:!1,"show-icon":""},{default:o(()=>[a("div",N,[e[5]||(e[5]=a("p",null,[a("strong",null,"邮箱："),i("test@example.com")],-1)),e[6]||(e[6]=a("p",null,[a("strong",null,"密码："),i("123456")],-1)),l(m,{type:"primary",size:"small",onClick:h,style:{"margin-top":"8px"}},{default:o(()=>[...e[4]||(e[4]=[i(" 使用测试账户登录 ",-1)])]),_:1})])]),_:1})]),l(M,{model:t,rules:V,ref_key:"loginFormRef",ref:p,"label-width":"80px"},{default:o(()=>[l(u,{label:"邮箱",prop:"email"},{default:o(()=>[l(s,{modelValue:t.email,"onUpdate:modelValue":e[0]||(e[0]=d=>t.email=d),placeholder:"请输入邮箱","prefix-icon":"MessageFilled"},null,8,["modelValue"])]),_:1}),l(u,{label:"密码",prop:"password"},{default:o(()=>[l(s,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=d=>t.password=d),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),l(u,null,{default:o(()=>[l(E,{modelValue:t.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=d=>t.rememberMe=d)},{default:o(()=>[...e[7]||(e[7]=[i("记住我",-1)])]),_:1},8,["modelValue"]),l(y,{type:"primary",underline:!1,class:"reset-password"},{default:o(()=>[...e[8]||(e[8]=[i("忘记密码？",-1)])]),_:1})]),_:1}),l(u,null,{default:o(()=>[l(m,{type:"primary",loading:c.value,onClick:_,style:{width:"100%"}},{default:o(()=>[...e[9]||(e[9]=[i("登录",-1)])]),_:1},8,["loading"])]),_:1}),a("div",j,[e[11]||(e[11]=a("span",null,"还没有账号？",-1)),l(y,{type:"primary",underline:!1,onClick:S},{default:o(()=>[...e[10]||(e[10]=[i("立即注册",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}});const z=B(q,[["__scopeId","data-v-3bfca46c"]]);export{z as default};
