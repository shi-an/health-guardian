import{d as C,u as R,g as b,h as w,c as S,b as l,w as r,e as F,r as a,o as I,a as i,f as m,E as y,_ as U}from"./index-b96a8e1c.js";const B={class:"login-container"},N={class:"register-link"},q=C({__name:"Login",setup(T){const g=F(),v=R(),d=b(),u=b(!1),_=localStorage.getItem("rememberedEmail")||"",o=w({email:_,password:"",rememberMe:!!_}),V=w({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}]}),k=async()=>{d.value&&await d.value.validate(async c=>{var e,t;if(c){u.value=!0;try{await v.login(o.email,o.password),o.rememberMe?localStorage.setItem("rememberedEmail",o.email):localStorage.removeItem("rememberedEmail"),y.success("登录成功"),g.push("/")}catch(s){const p=((t=(e=s.response)==null?void 0:e.data)==null?void 0:t.message)||"登录失败，请检查邮箱和密码";y.error(p),console.error("Login error:",s)}finally{u.value=!1}}})},x=()=>{g.push("/register")};return(c,e)=>{const t=a("el-input"),s=a("el-form-item"),p=a("el-checkbox"),f=a("el-link"),E=a("el-button"),M=a("el-form"),L=a("el-card");return I(),S("div",B,[l(L,{class:"login-card"},{header:r(()=>[...e[3]||(e[3]=[i("div",{class:"login-header"},[i("span",null,"用户登录")],-1)])]),default:r(()=>[l(M,{model:o,rules:V,ref_key:"loginFormRef",ref:d,"label-width":"80px"},{default:r(()=>[l(s,{label:"邮箱",prop:"email"},{default:r(()=>[l(t,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=n=>o.email=n),placeholder:"请输入邮箱","prefix-icon":"MessageFilled"},null,8,["modelValue"])]),_:1}),l(s,{label:"密码",prop:"password"},{default:r(()=>[l(t,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=n=>o.password=n),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),l(s,null,{default:r(()=>[l(p,{modelValue:o.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=n=>o.rememberMe=n)},{default:r(()=>[...e[4]||(e[4]=[m("记住我",-1)])]),_:1},8,["modelValue"]),l(f,{type:"primary",underline:!1,class:"reset-password"},{default:r(()=>[...e[5]||(e[5]=[m("忘记密码？",-1)])]),_:1})]),_:1}),l(s,null,{default:r(()=>[l(E,{type:"primary",loading:u.value,onClick:k,style:{width:"100%"}},{default:r(()=>[...e[6]||(e[6]=[m("登录",-1)])]),_:1},8,["loading"])]),_:1}),i("div",N,[e[8]||(e[8]=i("span",null,"还没有账号？",-1)),l(f,{type:"primary",underline:!1,onClick:x},{default:r(()=>[...e[7]||(e[7]=[m("立即注册",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}});const j=U(q,[["__scopeId","data-v-900a61ce"]]);export{j as default};
