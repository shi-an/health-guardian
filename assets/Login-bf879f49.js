import{d as L,u as R,g as b,h as w,c as S,b as l,w as s,e as F,r as a,o as I,a as m,f as d,E as y,_ as U}from"./index-224b1db4.js";const B={class:"login-container"},N={class:"register-link"},q=L({__name:"Login",setup(T){const g=F(),v=R(),u=b(),p=b(!1),_=localStorage.getItem("rememberedEmail")||"",o=w({email:_,password:"",rememberMe:!!_}),V=w({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}]}),k=async()=>{u.value&&await u.value.validate(async f=>{var e,n;if(f){p.value=!0;try{await v.login(o.email,o.password),o.rememberMe?localStorage.setItem("rememberedEmail",o.email):localStorage.removeItem("rememberedEmail"),y.success("登录成功"),g.push("/")}catch(r){console.error("登录失败:",r);let t="登录失败，请检查邮箱和密码";((e=r.response)==null?void 0:e.status)===401?t="邮箱或密码错误":((n=r.response)==null?void 0:n.status)===500?t="服务器错误，请稍后重试":r.message&&(t=r.message),y.error(t)}finally{p.value=!1}}})},x=()=>{g.push("/register")};return(f,e)=>{const n=a("el-input"),r=a("el-form-item"),t=a("el-checkbox"),c=a("el-link"),E=a("el-button"),M=a("el-form"),C=a("el-card");return I(),S("div",B,[l(C,{class:"login-card"},{header:s(()=>[...e[3]||(e[3]=[m("div",{class:"login-header"},[m("span",null,"用户登录")],-1)])]),default:s(()=>[l(M,{model:o,rules:V,ref_key:"loginFormRef",ref:u,"label-width":"80px"},{default:s(()=>[l(r,{label:"邮箱",prop:"email"},{default:s(()=>[l(n,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=i=>o.email=i),placeholder:"请输入邮箱","prefix-icon":"MessageFilled"},null,8,["modelValue"])]),_:1}),l(r,{label:"密码",prop:"password"},{default:s(()=>[l(n,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=i=>o.password=i),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),l(r,null,{default:s(()=>[l(t,{modelValue:o.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=i=>o.rememberMe=i)},{default:s(()=>[...e[4]||(e[4]=[d("记住我",-1)])]),_:1},8,["modelValue"]),l(c,{type:"primary",underline:!1,class:"reset-password"},{default:s(()=>[...e[5]||(e[5]=[d("忘记密码？",-1)])]),_:1})]),_:1}),l(r,null,{default:s(()=>[l(E,{type:"primary",loading:p.value,onClick:k,style:{width:"100%"}},{default:s(()=>[...e[6]||(e[6]=[d("登录",-1)])]),_:1},8,["loading"])]),_:1}),m("div",N,[e[8]||(e[8]=m("span",null,"还没有账号？",-1)),l(c,{type:"primary",underline:!1,onClick:x},{default:s(()=>[...e[7]||(e[7]=[d("立即注册",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}});const j=U(q,[["__scopeId","data-v-15485309"]]);export{j as default};
