import{d as C,u as F,g as v,h as b,c as P,b as r,w as o,e as q,r as p,o as E,a as t,f as y,E as V,_ as h}from"./index-224b1db4.js";const B={class:"register-container"},L={class:"register-tips"},M={class:"login-link"},N=C({__name:"Register",setup(S){const w=q(),x=F(),f=v(),c=v(!1),l=b({email:"",username:"",password:"",confirmPassword:""}),k=b({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在 2 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(_,e,n)=>{e!==l.password?n(new Error("两次输入密码不一致")):n()},trigger:"blur"}]}),R=async()=>{f.value&&await f.value.validate(async _=>{var e,n,i,a,m,g;if(_){c.value=!0;try{await x.register(l.username,l.email,l.password),V.success("注册成功，请登录"),w.push("/login")}catch(s){console.error("注册失败:",s),console.error("错误详情:",{message:s.message,response:s.response,status:(e=s.response)==null?void 0:e.status,data:(n=s.response)==null?void 0:n.data,config:s.config});let d="注册失败，请稍后重试";((i=s.response)==null?void 0:i.status)===400?d=((a=s.response.data)==null?void 0:a.message)||"输入信息有误，请检查":((m=s.response)==null?void 0:m.status)===409?d="该邮箱或用户名已被注册":((g=s.response)==null?void 0:g.status)===500?d="服务器错误，请稍后重试":s.message&&(d=s.message),V.error(d)}finally{c.value=!1}}})},U=()=>{w.push("/login")};return(_,e)=>{const n=p("el-alert"),i=p("el-input"),a=p("el-form-item"),m=p("el-button"),g=p("el-link"),s=p("el-form"),d=p("el-card");return E(),P("div",B,[r(d,{class:"register-card"},{header:o(()=>[...e[4]||(e[4]=[t("div",{class:"register-header"},[t("span",null,"用户注册")],-1)])]),default:o(()=>[r(s,{model:l,rules:k,ref_key:"registerFormRef",ref:f,"label-width":"80px"},{default:o(()=>[t("div",L,[r(n,{title:"注册须知",type:"info",closable:!1,"show-icon":""},{default:o(()=>[...e[5]||(e[5]=[t("div",{class:"tips-content"},[t("p",null,"• 邮箱必须为有效的电子邮件地址"),t("p",null,"• 用户名长度在2-20个字符之间"),t("p",null,"• 密码长度至少6位，建议包含字母和数字")],-1)])]),_:1})]),r(a,{label:"邮箱",prop:"email"},{default:o(()=>[r(i,{modelValue:l.email,"onUpdate:modelValue":e[0]||(e[0]=u=>l.email=u),placeholder:"请输入有效的邮箱地址","prefix-icon":"MessageFilled","show-word-limit":"",maxlength:50},null,8,["modelValue"])]),_:1}),r(a,{label:"用户名",prop:"username"},{default:o(()=>[r(i,{modelValue:l.username,"onUpdate:modelValue":e[1]||(e[1]=u=>l.username=u),placeholder:"请输入2-20个字符的用户名","prefix-icon":"UserFilled","show-word-limit":"",maxlength:20},null,8,["modelValue"]),e[6]||(e[6]=t("div",{class:"form-tip"},"用户名长度在2-20个字符之间",-1))]),_:1}),r(a,{label:"密码",prop:"password"},{default:o(()=>[r(i,{modelValue:l.password,"onUpdate:modelValue":e[2]||(e[2]=u=>l.password=u),type:"password",placeholder:"请输入至少6位密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"]),e[7]||(e[7]=t("div",{class:"form-tip"},"密码长度至少6位，建议包含字母和数字",-1))]),_:1}),r(a,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[r(i,{modelValue:l.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=u=>l.confirmPassword=u),type:"password",placeholder:"请再次输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),r(a,null,{default:o(()=>[r(m,{type:"primary",loading:c.value,onClick:R,style:{width:"100%"}},{default:o(()=>[...e[8]||(e[8]=[y("注册",-1)])]),_:1},8,["loading"])]),_:1}),t("div",M,[e[10]||(e[10]=t("span",null,"已有账号？",-1)),r(g,{type:"primary",underline:!1,onClick:U},{default:o(()=>[...e[9]||(e[9]=[y("立即登录",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}});const I=h(N,[["__scopeId","data-v-d1268d88"]]);export{I as default};
