import{d as U,u as S,r as v,l as y,c as E,e as o,w as l,g as P,h as m,i as C,b as t,j as b,E as k,_ as F}from"./index-e3d6c02a.js";const T={class:"register-container"},q={class:"register-tips"},D={class:"login-link"},I=U({__name:"Register",setup(N){const w=P(),V=S(),c=v(),f=v(!1),r=y({email:"",username:"",password:"",confirmPassword:""}),x=y({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在 2 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(_,e,u)=>{e!==r.password?u(new Error("两次输入密码不一致")):u()},trigger:"blur"}]}),h=async()=>{c.value&&await c.value.validate(async _=>{var e,u,d,i,p,g;if(_){f.value=!0;try{if(console.log("使用模拟注册功能..."),await new Promise(n=>setTimeout(n,1e3)),r.username.length<2||r.username.length>20)throw new Error("用户名长度必须在2-20个字符之间");if(r.password.length<6)throw new Error("密码长度必须至少为6位");const s={id:Date.now(),username:r.username,email:r.email,createdAt:new Date().toISOString(),healthData:{height:null,weight:null,age:null,gender:null}},a="mock_token_"+Date.now();localStorage.setItem("mockUser",JSON.stringify(s)),localStorage.setItem("token",a),V.user=s,k.success("注册成功，正在为您自动登录..."),setTimeout(()=>{w.push("/")},1500)}catch(s){console.error("注册失败:",s),console.error("错误详情:",{message:s.message,response:s.response,status:(e=s.response)==null?void 0:e.status,data:(u=s.response)==null?void 0:u.data,config:s.config});let a="注册失败，请稍后重试";((d=s.response)==null?void 0:d.status)===400?a=((i=s.response.data)==null?void 0:i.message)||"输入信息有误，请检查":((p=s.response)==null?void 0:p.status)===409?a="该邮箱或用户名已被注册":((g=s.response)==null?void 0:g.status)===500?a="服务器错误，请稍后重试":s.message&&(a=s.message),k.error(a)}finally{f.value=!1}}})},R=()=>{w.push("/login")};return(_,e)=>{const u=m("el-alert"),d=m("el-input"),i=m("el-form-item"),p=m("el-button"),g=m("el-link"),s=m("el-form"),a=m("el-card");return C(),E("div",T,[o(a,{class:"register-card"},{header:l(()=>[...e[4]||(e[4]=[t("div",{class:"register-header"},[t("span",null,"用户注册")],-1)])]),default:l(()=>[o(s,{model:r,rules:x,ref_key:"registerFormRef",ref:c,"label-width":"80px"},{default:l(()=>[t("div",q,[o(u,{title:"注册须知",type:"info",closable:!1,"show-icon":""},{default:l(()=>[...e[5]||(e[5]=[t("div",{class:"tips-content"},[t("p",null,"• 邮箱必须为有效的电子邮件地址"),t("p",null,"• 用户名长度在2-20个字符之间"),t("p",null,"• 密码长度至少6位，建议包含字母和数字")],-1)])]),_:1})]),o(i,{label:"邮箱",prop:"email"},{default:l(()=>[o(d,{modelValue:r.email,"onUpdate:modelValue":e[0]||(e[0]=n=>r.email=n),placeholder:"请输入有效的邮箱地址","prefix-icon":"MessageFilled","show-word-limit":"",maxlength:50},null,8,["modelValue"])]),_:1}),o(i,{label:"用户名",prop:"username"},{default:l(()=>[o(d,{modelValue:r.username,"onUpdate:modelValue":e[1]||(e[1]=n=>r.username=n),placeholder:"请输入2-20个字符的用户名","prefix-icon":"UserFilled","show-word-limit":"",maxlength:20},null,8,["modelValue"]),e[6]||(e[6]=t("div",{class:"form-tip"},"用户名长度在2-20个字符之间",-1))]),_:1}),o(i,{label:"密码",prop:"password"},{default:l(()=>[o(d,{modelValue:r.password,"onUpdate:modelValue":e[2]||(e[2]=n=>r.password=n),type:"password",placeholder:"请输入至少6位密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"]),e[7]||(e[7]=t("div",{class:"form-tip"},"密码长度至少6位，建议包含字母和数字",-1))]),_:1}),o(i,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[o(d,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=n=>r.confirmPassword=n),type:"password",placeholder:"请再次输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(i,null,{default:l(()=>[o(p,{type:"primary",loading:f.value,onClick:h,style:{width:"100%"}},{default:l(()=>[...e[8]||(e[8]=[b("注册",-1)])]),_:1},8,["loading"])]),_:1}),t("div",D,[e[10]||(e[10]=t("span",null,"已有账号？",-1)),o(g,{type:"primary",underline:!1,onClick:R},{default:l(()=>[...e[9]||(e[9]=[b("立即登录",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}});const L=F(I,[["__scopeId","data-v-ace8c34d"]]);export{L as default};
